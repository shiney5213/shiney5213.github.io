---
layout: post
title:  "[python] Deep Learning"
date:   2020-01-20 15:32:40 +0200
img: 200118_1.png
description: You’ll find this post in your `_posts` directory. Go ahead and edit it and re-build the site to see your changes.
categories: classification
permalink: '/classification/'
---




> 오버피팅
- 방정식의 개수가 많고, 미지수가 적기 때문에


## 역행렬을 이용한 최적해 구하기
> 2 by 2 행렬
- 역행렬이 존재하므로 a, b를 구할 수 있음.

> 정방행렬이 아닐 때
- 슈도 역행렬로 구할 수 있음.
- 의사역행렬: A + = (A.TA)-1 * A.T

> numpy를 수치 계산용으로 사용하는 이유
- 함수 안에 C로 구현 => 빠름
- 단일 데이터 type



```python
import numpy as np
import numpy.linalg as lin
```

# 1. (2,2)역행렬 구하기

#### 행렬의 2열은 항상 1 -> bias값이기 때문에


```python
a = np.array([[1,1],[2,1]])
a.shape
```




    (2, 2)




```python
a_ = lin.inv(a)
a_
```




    array([[-1.,  1.],
           [ 2., -1.]])




```python
y = np.array([2,4])

```

## 1.1. 산술 곱


```python
# W 를 곱하기 
w = a_ * y
w
```




    array([[-2.,  4.],
           [ 4., -4.]])



## 1.2. 행렬곱


```python
w = np.dot(a_, y)
w
```




    array([2., 0.])




```python
w = np.matmul(a_, y)
w
```




    array([2., 0.])



## 1.3. 행렬의 기본: column 방향


```python
# 행렬이 아닌 벡터
y = np.array([2,4])
y.shape
```




    (2,)




```python
# row 방향 행렬
y_= np.array([[2,4]])
y_.shape
```




    (1, 2)




```python
# column 방향 행렬
y_.T.shape
y_.reshape(2,1).shape
```




    (2, 1)




```python
# column 방향 행렬
y_2 = np.array([[2],[4]])
y_2.shape
```




    (2, 1)




```python
w = np.matmul(a_, y_2)
w.shape

# 2차원 행렬에 주의
```




    (2, 1)




```python
w
```




    array([[2.],
           [0.]])



# 2. (2,3) 역행렬 구하기

> 점이 3개가 있는 경우
- 점 3개를 선형으로 표현할 수가 없음.
- 점 2개 / 점2개를 조합하는 모델을 만들어야 함.
- 우리가 원하는 것은 -무한대 ~ 무한대를 표현하는 직선의 방정식을 표현하기 위해
- 


```python
a = np.array([[1,1],[2,1],[3,1]])
a_ = lin.inv(a)

# 정방행렬이 아니기 때문에 역행렬 구할 수 없음.
```


    ---------------------------------------------------------------------------

    LinAlgError                               Traceback (most recent call last)

    <ipython-input-26-bb7e601f9e04> in <module>
          1 a = np.array([[1,1],[2,1],[3,1]])
    ----> 2 a_ = lin.inv(a)
    

    C:\anaconda\lib\site-packages\numpy\linalg\linalg.py in inv(a)
        544     a, wrap = _makearray(a)
        545     _assertRankAtLeast2(a)
    --> 546     _assertNdSquareness(a)
        547     t, result_t = _commonType(a)
        548 
    

    C:\anaconda\lib\site-packages\numpy\linalg\linalg.py in _assertNdSquareness(*arrays)
        211         m, n = a.shape[-2:]
        212         if m != n:
    --> 213             raise LinAlgError('Last 2 dimensions of the array must be square')
        214 
        215 def _assertFinite(*arrays):
    

    LinAlgError: Last 2 dimensions of the array must be square


## 2.1. 슈도 역행렬 구하기(pseudo inverse)


```python
a_ = lin.pinv(a)
a_
```




    array([[-5.00000000e-01, -3.19189120e-16,  5.00000000e-01],
           [ 1.33333333e+00,  3.33333333e-01, -6.66666667e-01]])




```python
y = np.array([2,4,6]).reshape(3,1)
w = np.matmul(a_, y)
w
```




    array([[ 2.0000000e+00],
           [-8.8817842e-16]])



## 2.2. 예측값 구하기


```python
x = 1
y = w[0][0]* x + w[1][0]
y
```




    1.9999999999999991



## 2.3. 해석
- 내가 찾은 직선으로는 정확하게 데이터(x, y)를 표현할 수 없음.
- 오차가 있을수밖에 없음.


```python

```


```python

```


```python

```


```python
a = np.array([[2,2,0],[-2,1,1]])
Σ Wx > b
# 역행렬
lin.inv(a)
```


    ---------------------------------------------------------------------------

    LinAlgError                               Traceback (most recent call last)

    <ipython-input-2-eda971859dc1> in <module>
          1 a = np.array([[2,2,0],[-2,1,1]])
    ----> 2 lin.inv(a)
    

    C:\anaconda\lib\site-packages\numpy\linalg\linalg.py in inv(a)
        544     a, wrap = _makearray(a)
        545     _assertRankAtLeast2(a)
    --> 546     _assertNdSquareness(a)
        547     t, result_t = _commonType(a)
        548 
    

    C:\anaconda\lib\site-packages\numpy\linalg\linalg.py in _assertNdSquareness(*arrays)
        211         m, n = a.shape[-2:]
        212         if m != n:
    --> 213             raise LinAlgError('Last 2 dimensions of the array must be square')
        214 
        215 def _assertFinite(*arrays):
    

    LinAlgError: Last 2 dimensions of the array must be square



```python
a = np.array([[1,2],[2,4],[3,6.4]])
np.linalg.pinv(a)
```




    array([[ 3.2,  6.4, -5. ],
           [-1.5, -3. ,  2.5]])




```python

```
